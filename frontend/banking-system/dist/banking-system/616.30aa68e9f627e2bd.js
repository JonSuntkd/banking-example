"use strict";(self.webpackChunkbanking_system=self.webpackChunkbanking_system||[]).push([[616],{5616:(S,f,l)=>{l.r(f),l.d(f,{ClientModule:()=>w});var d=l(177),o=l(4341),m=l(408),h=l(1626),g=l(1413),c=l(6977),t=l(4438);let p=(()=>{class n{constructor(e){this.http=e,this.baseUrl="http://localhost:8001/api/v1/client"}createBasicClient(e){return this.http.post(`${this.baseUrl}/basic`,e)}getAllClients(){return this.http.get(this.baseUrl)}getClientById(e){return this.http.get(`${this.baseUrl}/${e}`)}updateClient(e,r){return this.http.put(`${this.baseUrl}/${e}`,r)}activateClient(e){return this.http.patch(`${this.baseUrl}/${e}/activate`,{})}deactivateClient(e){return this.http.patch(`${this.baseUrl}/${e}/deactivate`,{})}deleteClient(e){return this.http.delete(`${this.baseUrl}/${e}`)}static{this.\u0275fac=function(r){return new(r||n)(t.KVO(h.Qq))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function _(n,s){1&n&&(t.j41(0,"div",9),t.nrm(1,"div",10),t.EFF(2," Cargando clientes...\n"),t.k0s())}function b(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",11),t.EFF(1),t.j41(2,"button",12),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.loadClients())}),t.EFF(3," Reintentar "),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(),t.SpI(" ",e.error," ")}}function F(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(2);return t.Njj(a.activateClient(i.id))}),t.EFF(1," Activar "),t.k0s()}}function v(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",24),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(2);return t.Njj(a.deactivateClient(i.id))}),t.EFF(1," Desactivar "),t.k0s()}}function E(n,s){if(1&n){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"span",17),t.EFF(11),t.k0s()(),t.j41(12,"td")(13,"div",18)(14,"button",19),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(2);return t.Njj(a.editClient(i.id))}),t.EFF(15," Editar "),t.k0s(),t.DNE(16,F,2,0,"button",20)(17,v,2,0,"button",21),t.j41(18,"button",22),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(2);return t.Njj(a.deleteClient(i.id))}),t.EFF(19," Eliminar "),t.k0s()()()()}if(2&n){const e=s.$implicit,r=t.XpG(2);t.R7$(2),t.JRh(e.id),t.R7$(2),t.JRh(e.person.fullName),t.R7$(2),t.JRh(e.person.address),t.R7$(2),t.JRh(e.person.phone),t.R7$(2),t.Y8G("ngClass",r.getStatusClass(e.status)),t.R7$(),t.SpI(" ",r.getStatusText(e.status)," "),t.R7$(5),t.Y8G("ngIf",!e.status),t.R7$(),t.Y8G("ngIf",e.status)}}function k(n,s){1&n&&(t.j41(0,"tr")(1,"td",25)(2,"em"),t.EFF(3,"No se encontraron clientes"),t.k0s()()())}function $(n,s){if(1&n&&(t.j41(0,"div",13)(1,"table",14)(2,"thead")(3,"tr")(4,"th"),t.EFF(5,"ID"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Nombre Completo"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Direcci\xf3n"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Tel\xe9fono"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Estado"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Acciones"),t.k0s()()(),t.j41(16,"tbody"),t.DNE(17,E,20,8,"tr",15)(18,k,4,0,"tr",16),t.k0s()()()),2&n){const e=t.XpG();t.R7$(17),t.Y8G("ngForOf",e.filteredClients)("ngForTrackBy",e.trackByClientId),t.R7$(),t.Y8G("ngIf",0===e.filteredClients.length)}}let x=(()=>{class n{constructor(e,r){this.clientUseCases=e,this.router=r,this.clients=[],this.filteredClients=[],this.loading=!1,this.error=null,this.searchTerm="",this.destroy$=new g.B}ngOnInit(){this.loadClients()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadClients(){this.loading=!0,this.error=null,this.clientUseCases.getAllClients().pipe((0,c.Q)(this.destroy$)).subscribe({next:e=>{this.clients=e,this.filteredClients=e,this.loading=!1},error:e=>{this.error="Error al cargar los clientes: "+e.message,this.loading=!1}})}onSearch(){if(!this.searchTerm.trim())return void(this.filteredClients=this.clients);const e=this.searchTerm.toLowerCase();this.filteredClients=this.clients.filter(r=>r.person.fullName.toLowerCase().includes(e)||r.person.phone.toLowerCase().includes(e)||r.person.address.toLowerCase().includes(e))}createClient(){this.router.navigate(["/clientes/nuevo"])}editClient(e){this.router.navigate(["/clientes/editar",e])}activateClient(e){confirm("\xbfEst\xe1 seguro de que desea activar este cliente?")&&this.clientUseCases.activateClient(e).pipe((0,c.Q)(this.destroy$)).subscribe({next:()=>{this.loadClients()},error:r=>{this.error="Error al activar el cliente: "+r.message}})}deactivateClient(e){confirm("\xbfEst\xe1 seguro de que desea desactivar este cliente?")&&this.clientUseCases.deactivateClient(e).pipe((0,c.Q)(this.destroy$)).subscribe({next:()=>{this.loadClients()},error:r=>{this.error="Error al desactivar el cliente: "+r.message}})}deleteClient(e){confirm("\xbfEst\xe1 seguro de que desea eliminar este cliente? Esta acci\xf3n no se puede deshacer.")&&this.clientUseCases.deleteClient(e).pipe((0,c.Q)(this.destroy$)).subscribe({next:()=>{this.loadClients()},error:r=>{this.error="Error al eliminar el cliente: "+r.message}})}getStatusClass(e){return e?"status-active":"status-inactive"}getStatusText(e){return e?"Activo":"Inactivo"}trackByClientId(e,r){return r.id||e}static{this.\u0275fac=function(r){return new(r||n)(t.rXU(p),t.rXU(m.Ix))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-client-list"]],decls:11,vars:4,consts:[[1,"content-header"],[1,"page-title"],[1,"action-bar"],[1,"search-container"],["type","text","placeholder","Buscar",1,"search-input",3,"ngModelChange","input","ngModel"],[1,"btn","btn-primary",3,"click"],["class","text-center",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","data-table",4,"ngIf"],[1,"text-center"],[1,"loading-spinner"],[1,"alert","alert-danger"],[1,"btn","btn-secondary","mt-2",3,"click"],[1,"data-table"],[1,"table"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"status-badge",3,"ngClass"],[1,"d-flex","gap-1"],["title","Editar",1,"btn","btn-warning","btn-sm",3,"click"],["class","btn btn-success btn-sm","title","Activar",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm","title","Desactivar",3,"click",4,"ngIf"],["title","Eliminar",1,"btn","btn-danger","btn-sm",3,"click"],["title","Activar",1,"btn","btn-success","btn-sm",3,"click"],["title","Desactivar",1,"btn","btn-secondary","btn-sm",3,"click"],["colspan","6",1,"text-center"]],template:function(r,i){1&r&&(t.j41(0,"div",0)(1,"h1",1),t.EFF(2,"Clientes"),t.k0s()(),t.j41(3,"div",2)(4,"div",3)(5,"input",4),t.mxI("ngModelChange",function(u){return t.DH7(i.searchTerm,u)||(i.searchTerm=u),u}),t.bIt("input",function(){return i.onSearch()}),t.k0s()(),t.j41(6,"button",5),t.bIt("click",function(){return i.createClient()}),t.EFF(7," Nuevo "),t.k0s()(),t.DNE(8,_,3,0,"div",6)(9,b,4,1,"div",7)(10,$,19,3,"div",8)),2&r&&(t.R7$(5),t.R50("ngModel",i.searchTerm),t.R7$(3),t.Y8G("ngIf",i.loading),t.R7$(),t.Y8G("ngIf",i.error),t.R7$(),t.Y8G("ngIf",!i.loading&&!i.error))},dependencies:[d.YU,d.Sq,d.bT,o.me,o.BC,o.vS],styles:[".btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem;min-width:auto}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:.375rem;margin-bottom:1rem}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.table[_ngcontent-%COMP%]{font-size:.9rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.85rem;text-transform:uppercase;letter-spacing:.5px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.btn-group[_ngcontent-%COMP%]{display:flex;gap:.25rem}.status-badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}@media (max-width: 768px){.table[_ngcontent-%COMP%]{font-size:.8rem}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}}"]})}}return n})();function I(n,s){if(1&n&&(t.j41(0,"div",6),t.nrm(1,"div",7),t.EFF(2),t.k0s()),2&n){const e=t.XpG();t.R7$(2),t.SpI(" ",e.isEditMode?"Cargando datos del cliente...":"Guardando cliente..."," ")}}function j(n,s){if(1&n&&(t.j41(0,"div",8),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.SpI(" ",e.error," ")}}function y(n,s){if(1&n&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.getErrorMessage("fullName")," ")}}function R(n,s){if(1&n&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.getErrorMessage("identification")," ")}}function M(n,s){if(1&n&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.getErrorMessage("age")," ")}}function N(n,s){if(1&n&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.getErrorMessage("address")," ")}}function G(n,s){if(1&n&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.getErrorMessage("phone")," ")}}function T(n,s){if(1&n&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.getErrorMessage("password")," ")}}function O(n,s){1&n&&t.nrm(0,"span",7)}function D(n,s){if(1&n){const e=t.RV6();t.j41(0,"form",9),t.bIt("ngSubmit",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onSubmit())}),t.j41(1,"div",10)(2,"label",11),t.EFF(3,"Nombre Completo *"),t.k0s(),t.nrm(4,"input",12),t.DNE(5,y,2,1,"div",13),t.k0s(),t.j41(6,"div",10)(7,"label",14),t.EFF(8,"Identificaci\xf3n"),t.k0s(),t.nrm(9,"input",15),t.DNE(10,R,2,1,"div",13),t.k0s(),t.j41(11,"div",10)(12,"label",16),t.EFF(13,"G\xe9nero"),t.k0s(),t.j41(14,"select",17)(15,"option",18),t.EFF(16,"Seleccione un g\xe9nero"),t.k0s(),t.j41(17,"option",19),t.EFF(18,"Hombre"),t.k0s(),t.j41(19,"option",20),t.EFF(20,"Mujer"),t.k0s()()(),t.j41(21,"div",10)(22,"label",21),t.EFF(23,"Edad"),t.k0s(),t.nrm(24,"input",22),t.DNE(25,M,2,1,"div",13),t.k0s(),t.j41(26,"div",10)(27,"label",23),t.EFF(28,"Direcci\xf3n *"),t.k0s(),t.nrm(29,"textarea",24),t.DNE(30,N,2,1,"div",13),t.k0s(),t.j41(31,"div",10)(32,"label",25),t.EFF(33,"Tel\xe9fono *"),t.k0s(),t.nrm(34,"input",26),t.DNE(35,G,2,1,"div",13),t.k0s(),t.j41(36,"div",10)(37,"label",27),t.EFF(38,"Contrase\xf1a *"),t.k0s(),t.nrm(39,"input",28),t.DNE(40,T,2,1,"div",13),t.k0s(),t.j41(41,"div",10)(42,"label",29),t.nrm(43,"input",30),t.EFF(44," Cliente Activo "),t.k0s()(),t.j41(45,"div",31)(46,"button",32),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onCancel())}),t.EFF(47," Cancelar "),t.k0s(),t.j41(48,"button",33),t.DNE(49,O,1,0,"span",34),t.EFF(50),t.k0s()()()}if(2&n){const e=t.XpG();t.Y8G("formGroup",e.clientForm),t.R7$(4),t.AVh("error",e.hasError("fullName")),t.R7$(),t.Y8G("ngIf",e.hasError("fullName")),t.R7$(4),t.AVh("error",e.hasError("identification")),t.R7$(),t.Y8G("ngIf",e.hasError("identification")),t.R7$(14),t.AVh("error",e.hasError("age")),t.R7$(),t.Y8G("ngIf",e.hasError("age")),t.R7$(4),t.AVh("error",e.hasError("address")),t.R7$(),t.Y8G("ngIf",e.hasError("address")),t.R7$(4),t.AVh("error",e.hasError("phone")),t.R7$(),t.Y8G("ngIf",e.hasError("phone")),t.R7$(4),t.AVh("error",e.hasError("password")),t.R7$(),t.Y8G("ngIf",e.hasError("password")),t.R7$(6),t.Y8G("disabled",e.loading),t.R7$(2),t.Y8G("disabled",e.loading||e.clientForm.invalid),t.R7$(),t.Y8G("ngIf",e.loading),t.R7$(),t.SpI(" ",e.isEditMode?"Actualizar":"Crear"," ")}}let C=(()=>{class n{constructor(e,r,i,a){this.fb=e,this.clientUseCases=r,this.router=i,this.route=a,this.loading=!1,this.error=null,this.isEditMode=!1,this.clientId=null,this.destroy$=new g.B,this.clientForm=this.createForm()}ngOnInit(){this.checkEditMode()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}createForm(){return this.fb.group({fullName:["",[o.k0.required,o.k0.minLength(2)]],address:["",[o.k0.required,o.k0.minLength(5)]],phone:["",[o.k0.required,o.k0.pattern(/^[+]?[\d\s\-()]+$/)]],password:["",[o.k0.required,o.k0.minLength(6)]],status:[!0],gender:[""],age:["",[o.k0.min(18),o.k0.max(120)]],identification:["",[o.k0.pattern(/^\d{10,13}$/)]]})}checkEditMode(){const e=this.route.snapshot.paramMap.get("id");e&&(this.isEditMode=!0,this.clientId=parseInt(e,10),this.loadClientData())}loadClientData(){this.clientId&&(this.loading=!0,this.clientUseCases.getClientById(this.clientId).pipe((0,c.Q)(this.destroy$)).subscribe({next:e=>{this.populateForm(e),this.loading=!1},error:e=>{this.error="Error al cargar los datos del cliente: "+e.message,this.loading=!1}}))}populateForm(e){this.clientForm.patchValue({fullName:e.person.fullName,address:e.person.address,phone:e.person.phone,password:e.password,status:e.status,gender:e.person.gender||"",age:e.person.age||"",identification:e.person.identification||""})}onSubmit(){this.clientForm.invalid?this.markFormGroupTouched():(this.loading=!0,this.error=null,this.isEditMode?this.updateClient():this.createClient())}createClient(){const e=this.clientForm.value;this.clientUseCases.createBasicClient({fullName:e.fullName,address:e.address,phone:e.phone,password:e.password,status:e.status}).pipe((0,c.Q)(this.destroy$)).subscribe({next:()=>{this.router.navigate(["/clientes"])},error:i=>{this.error="Error al crear el cliente: "+i.message,this.loading=!1}})}updateClient(){if(!this.clientId)return;const e=this.clientForm.value;this.clientUseCases.updateClient(this.clientId,{person:{fullName:e.fullName,address:e.address,phone:e.phone,gender:e.gender||void 0,age:e.age||void 0,identification:e.identification||void 0},password:e.password,status:e.status}).pipe((0,c.Q)(this.destroy$)).subscribe({next:()=>{this.router.navigate(["/clientes"])},error:i=>{this.error="Error al actualizar el cliente: "+i.message,this.loading=!1}})}onCancel(){this.router.navigate(["/clientes"])}markFormGroupTouched(){Object.keys(this.clientForm.controls).forEach(e=>{this.clientForm.get(e)?.markAsTouched()})}hasError(e,r){const i=this.clientForm.get(e);return!!i&&(r?i.hasError(r)&&(i.dirty||i.touched):i.invalid&&(i.dirty||i.touched))}getErrorMessage(e){const r=this.clientForm.get(e);if(!r||!r.errors)return"";const i=r.errors;return i.required?`${this.getFieldDisplayName(e)} es requerido`:i.minlength?`${this.getFieldDisplayName(e)} debe tener al menos ${i.minlength.requiredLength} caracteres`:i.pattern?`${this.getFieldDisplayName(e)} tiene un formato inv\xe1lido`:i.min?`La edad m\xednima es ${i.min.min} a\xf1os`:i.max?`La edad m\xe1xima es ${i.max.max} a\xf1os`:"Campo inv\xe1lido"}getFieldDisplayName(e){return{fullName:"Nombre completo",address:"Direcci\xf3n",phone:"Tel\xe9fono",password:"Contrase\xf1a",gender:"G\xe9nero",age:"Edad",identification:"Identificaci\xf3n"}[e]||e}static{this.\u0275fac=function(r){return new(r||n)(t.rXU(o.ok),t.rXU(p),t.rXU(m.Ix),t.rXU(m.nX))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-client-form"]],decls:7,vars:4,consts:[[1,"content-header"],[1,"page-title"],[1,"form-container"],["class","text-center",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"text-center"],[1,"loading-spinner"],[1,"alert","alert-danger"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","fullName",1,"form-label"],["type","text","id","fullName","formControlName","fullName","placeholder","Ingrese el nombre completo",1,"form-control"],["class","error-message",4,"ngIf"],["for","identification",1,"form-label"],["type","text","id","identification","formControlName","identification","placeholder","N\xfamero de c\xe9dula o identificaci\xf3n",1,"form-control"],["for","gender",1,"form-label"],["id","gender","formControlName","gender",1,"form-control"],["value",""],["value","HOMBRE"],["value","MUJER"],["for","age",1,"form-label"],["type","number","id","age","formControlName","age","min","18","max","120","placeholder","Edad en a\xf1os",1,"form-control"],["for","address",1,"form-label"],["id","address","formControlName","address","rows","3","placeholder","Ingrese la direcci\xf3n completa",1,"form-control"],["for","phone",1,"form-label"],["type","tel","id","phone","formControlName","phone","placeholder","Ej: +593-99-123-4567",1,"form-control"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","M\xednimo 6 caracteres",1,"form-control"],[1,"form-label"],["type","checkbox","formControlName","status"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","loading-spinner",4,"ngIf"],[1,"error-message"]],template:function(r,i){1&r&&(t.j41(0,"div",0)(1,"h1",1),t.EFF(2),t.k0s()(),t.j41(3,"div",2),t.DNE(4,I,3,1,"div",3)(5,j,2,1,"div",4)(6,D,51,23,"form",5),t.k0s()),2&r&&(t.R7$(2),t.SpI(" ",i.isEditMode?"Editar Cliente":"Nuevo Cliente"," "),t.R7$(2),t.Y8G("ngIf",i.loading),t.R7$(),t.Y8G("ngIf",i.error),t.R7$(),t.Y8G("ngIf",!i.loading))},dependencies:[d.bT,o.qT,o.xH,o.y7,o.me,o.Q0,o.Zm,o.wz,o.BC,o.cb,o.VZ,o.zX,o.j4,o.JD],styles:[".form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem;font-weight:500;color:#2c3e50}.form-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin:0;width:auto}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:.375rem;margin-bottom:1rem}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.form-control.error[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 2px #dc354540}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem;margin-top:.25rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;margin-top:2rem;padding-top:1rem;border-top:1px solid #e0e0e0}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{margin-right:.5rem}@media (max-width: 768px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-container[_ngcontent-%COMP%]{padding:1rem}}"]})}}return n})();const X=[{path:"",component:x},{path:"nuevo",component:C},{path:"editar/:id",component:C}];let w=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({providers:[p],imports:[d.MD,o.X1,o.YN,m.iI.forChild(X),h.q1]})}}return n})()}}]);